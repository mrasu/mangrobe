syntax = "proto3";

package mangroove.api;

service SnapshotService {
  rpc GetSnapshot(GetSnapshotRequest) returns (GetSnapshotResponse) {};
}

service ActionService {
  rpc ChangeFiles(ChangeFilesRequest) returns (ChangeFilesResponse);
}

message GetSnapshotRequest {}

message GetSnapshotResponse {
  Snapshot snapshot = 1;
}

message Snapshot {
  repeated File files = 1;
}

message File {
  string path = 1;
  int64 size = 2;
}

message ChangeFilesRequest {
  // Must be shorter than 32 characters
  string idempotency_key = 1;

  repeated AddedFile added_files = 2;
}

message AddedFile {
  string path = 1;
  int64 size = 2;
}

message ChangeFilesResponse {
  int64 ChangeLogId = 1;
}
